<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.5" />
<title>api.resources.event API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>api.resources.event</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from flask import make_response, current_app as app
from flask_restful import Resource, reqparse
from datetime import datetime
from bson import ObjectId

from api.resources.constants import HttpStatusCode
from api.resources.auth import token_required

base_parser = reqparse.RequestParser()
base_parser.add_argument(&#39;name&#39;, required=True, location=&#39;json&#39;)
base_parser.add_argument(&#39;start_datetime&#39;, required=True, location=&#39;json&#39;)
base_parser.add_argument(&#39;end_datetime&#39;, required=True, location=&#39;json&#39;)
base_parser.add_argument(&#39;max_guests_allowed&#39;, required=True, type=int, location=&#39;json&#39;)
base_parser.add_argument(&#39;cuisine&#39;, required=True, action=&#39;append&#39;, location=&#39;json&#39;)
base_parser.add_argument(&#39;price_per_person&#39;, required=True, type=float, location=&#39;json&#39;)
base_parser.add_argument(&#39;description&#39;, required=True, location=&#39;json&#39;)


class Event(Resource):

    def __init__(self):
        self.parser = base_parser.copy()

        for arg in self.parser.args:
            arg.required = False

        self.parser.add_argument(&#39;guests&#39;, action=&#39;append&#39;, location=&#39;json&#39;)
        self.parser.add_argument(&#39;rating&#39;, location=&#39;json&#39;)

    def get(self, id):
        if not ObjectId.is_valid(id):
            return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

        object_id = ObjectId(id)

        event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

        if not event:
            return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

        event[&#39;_id&#39;] = str(event[&#39;_id&#39;])

        return make_response({&#39;data&#39;: event}, HttpStatusCode.HTTP_200_OK)

    @token_required
    def put(self, user_id, id):
        if not ObjectId.is_valid(id):
            return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

        args = self.parser.parse_args()

        object_id = ObjectId(id)

        events = app.mongo.db.events

        event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

        if not event:
            return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

        fields = {key: value for key,
                  value in args.items() if value is not None}

        events.update_one({&#39;_id&#39;: object_id},
                          {
            &#39;$push&#39;: {
                &#39;changes&#39;: {
                    &#39;fields&#39;: fields,
                    &#39;updated_by_user&#39;: user_id,
                    &#39;updated_datetime&#39;: datetime.utcnow()
                }
            }
        })

        return &#39;[HTTP_204_NO_CONTENT]&#39;, HttpStatusCode.HTTP_204_NO_CONTENT


class EventList(Resource):

    def __init__(self):
        self.parser = base_parser.copy()

    def get(self):
        response = []
        events = app.mongo.db.events.find()

        for event in events:
            event[&#39;_id&#39;] = str(event[&#39;_id&#39;])
            response.append(event)

        return make_response({&#39;data&#39;: response}, HttpStatusCode.HTTP_200_OK)

    @token_required
    def post(self, user_id):
        args = self.parser.parse_args()

        events = app.mongo.db.events

        events.insert_one({
            &#39;host_id&#39;: user_id,
            &#39;name&#39;: args[&#39;name&#39;],
            &#39;start_datetime&#39;: args[&#39;start_datetime&#39;],
            &#39;end_datetime&#39;: args[&#39;end_datetime&#39;],
            &#39;max_guests_allowed&#39;: args[&#39;max_guests_allowed&#39;],
            &#39;cuisine&#39;: args[&#39;cuisine&#39;],
            &#39;price_per_person&#39;: args[&#39;price_per_person&#39;],
            &#39;description&#39;: args[&#39;description&#39;],
            &#39;published:&#39;: True,
            &#39;view_count:&#39;: 0,
            &#39;created_by_user&#39;: user_id,
            &#39;created_datetime&#39;: datetime.utcnow()
        })

        return make_response(&#39;[HTTP_201_CREATED]&#39;, HttpStatusCode.HTTP_201_CREATED)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="api.resources.event.Event"><code class="flex name class">
<span>class <span class="ident">Event</span></span>
</code></dt>
<dd>
<section class="desc"><p>Represents an abstract RESTful resource. Concrete resources should
extend from this class and expose methods for each supported HTTP
method. If a resource is invoked with an unsupported HTTP method,
the API will return a response with status 405 Method Not Allowed.
Otherwise the appropriate method is called and passed all arguments
from the url rule used when adding the resource to an Api instance. See
:meth:<code>~flask_restful.Api.add_resource</code> for details.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Event(Resource):

    def __init__(self):
        self.parser = base_parser.copy()

        for arg in self.parser.args:
            arg.required = False

        self.parser.add_argument(&#39;guests&#39;, action=&#39;append&#39;, location=&#39;json&#39;)
        self.parser.add_argument(&#39;rating&#39;, location=&#39;json&#39;)

    def get(self, id):
        if not ObjectId.is_valid(id):
            return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

        object_id = ObjectId(id)

        event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

        if not event:
            return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

        event[&#39;_id&#39;] = str(event[&#39;_id&#39;])

        return make_response({&#39;data&#39;: event}, HttpStatusCode.HTTP_200_OK)

    @token_required
    def put(self, user_id, id):
        if not ObjectId.is_valid(id):
            return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

        args = self.parser.parse_args()

        object_id = ObjectId(id)

        events = app.mongo.db.events

        event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

        if not event:
            return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

        fields = {key: value for key,
                  value in args.items() if value is not None}

        events.update_one({&#39;_id&#39;: object_id},
                          {
            &#39;$push&#39;: {
                &#39;changes&#39;: {
                    &#39;fields&#39;: fields,
                    &#39;updated_by_user&#39;: user_id,
                    &#39;updated_datetime&#39;: datetime.utcnow()
                }
            }
        })

        return &#39;[HTTP_204_NO_CONTENT]&#39;, HttpStatusCode.HTTP_204_NO_CONTENT</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>flask_restful.Resource</li>
<li>flask.views.MethodView</li>
<li>flask.views.View</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="api.resources.event.Event.methods"><code class="name">var <span class="ident">methods</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="api.resources.event.Event.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self, id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self, id):
    if not ObjectId.is_valid(id):
        return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

    object_id = ObjectId(id)

    event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

    if not event:
        return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

    event[&#39;_id&#39;] = str(event[&#39;_id&#39;])

    return make_response({&#39;data&#39;: event}, HttpStatusCode.HTTP_200_OK)</code></pre>
</details>
</dd>
<dt id="api.resources.event.Event.put"><code class="name flex">
<span>def <span class="ident">put</span></span>(<span>self, user_id, id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@token_required
def put(self, user_id, id):
    if not ObjectId.is_valid(id):
        return make_response(&#39;[HTTP_400_BAD_REQUEST]&#39;, HttpStatusCode.HTTP_400_BAD_REQUEST)

    args = self.parser.parse_args()

    object_id = ObjectId(id)

    events = app.mongo.db.events

    event = app.mongo.db.events.find_one({&#39;_id&#39;: object_id})

    if not event:
        return make_response(&#39;[HTTP_404_NOT_FOUND]&#39;, HttpStatusCode.HTTP_404_NOT_FOUND)

    fields = {key: value for key,
              value in args.items() if value is not None}

    events.update_one({&#39;_id&#39;: object_id},
                      {
        &#39;$push&#39;: {
            &#39;changes&#39;: {
                &#39;fields&#39;: fields,
                &#39;updated_by_user&#39;: user_id,
                &#39;updated_datetime&#39;: datetime.utcnow()
            }
        }
    })

    return &#39;[HTTP_204_NO_CONTENT]&#39;, HttpStatusCode.HTTP_204_NO_CONTENT</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="api.resources.event.EventList"><code class="flex name class">
<span>class <span class="ident">EventList</span></span>
</code></dt>
<dd>
<section class="desc"><p>Represents an abstract RESTful resource. Concrete resources should
extend from this class and expose methods for each supported HTTP
method. If a resource is invoked with an unsupported HTTP method,
the API will return a response with status 405 Method Not Allowed.
Otherwise the appropriate method is called and passed all arguments
from the url rule used when adding the resource to an Api instance. See
:meth:<code>~flask_restful.Api.add_resource</code> for details.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EventList(Resource):

    def __init__(self):
        self.parser = base_parser.copy()

    def get(self):
        response = []
        events = app.mongo.db.events.find()

        for event in events:
            event[&#39;_id&#39;] = str(event[&#39;_id&#39;])
            response.append(event)

        return make_response({&#39;data&#39;: response}, HttpStatusCode.HTTP_200_OK)

    @token_required
    def post(self, user_id):
        args = self.parser.parse_args()

        events = app.mongo.db.events

        events.insert_one({
            &#39;host_id&#39;: user_id,
            &#39;name&#39;: args[&#39;name&#39;],
            &#39;start_datetime&#39;: args[&#39;start_datetime&#39;],
            &#39;end_datetime&#39;: args[&#39;end_datetime&#39;],
            &#39;max_guests_allowed&#39;: args[&#39;max_guests_allowed&#39;],
            &#39;cuisine&#39;: args[&#39;cuisine&#39;],
            &#39;price_per_person&#39;: args[&#39;price_per_person&#39;],
            &#39;description&#39;: args[&#39;description&#39;],
            &#39;published:&#39;: True,
            &#39;view_count:&#39;: 0,
            &#39;created_by_user&#39;: user_id,
            &#39;created_datetime&#39;: datetime.utcnow()
        })

        return make_response(&#39;[HTTP_201_CREATED]&#39;, HttpStatusCode.HTTP_201_CREATED)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>flask_restful.Resource</li>
<li>flask.views.MethodView</li>
<li>flask.views.View</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="api.resources.event.EventList.methods"><code class="name">var <span class="ident">methods</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="api.resources.event.EventList.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self):
    response = []
    events = app.mongo.db.events.find()

    for event in events:
        event[&#39;_id&#39;] = str(event[&#39;_id&#39;])
        response.append(event)

    return make_response({&#39;data&#39;: response}, HttpStatusCode.HTTP_200_OK)</code></pre>
</details>
</dd>
<dt id="api.resources.event.EventList.post"><code class="name flex">
<span>def <span class="ident">post</span></span>(<span>self, user_id)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@token_required
def post(self, user_id):
    args = self.parser.parse_args()

    events = app.mongo.db.events

    events.insert_one({
        &#39;host_id&#39;: user_id,
        &#39;name&#39;: args[&#39;name&#39;],
        &#39;start_datetime&#39;: args[&#39;start_datetime&#39;],
        &#39;end_datetime&#39;: args[&#39;end_datetime&#39;],
        &#39;max_guests_allowed&#39;: args[&#39;max_guests_allowed&#39;],
        &#39;cuisine&#39;: args[&#39;cuisine&#39;],
        &#39;price_per_person&#39;: args[&#39;price_per_person&#39;],
        &#39;description&#39;: args[&#39;description&#39;],
        &#39;published:&#39;: True,
        &#39;view_count:&#39;: 0,
        &#39;created_by_user&#39;: user_id,
        &#39;created_datetime&#39;: datetime.utcnow()
    })

    return make_response(&#39;[HTTP_201_CREATED]&#39;, HttpStatusCode.HTTP_201_CREATED)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="api.resources" href="index.html">api.resources</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="api.resources.event.Event" href="#api.resources.event.Event">Event</a></code></h4>
<ul class="">
<li><code><a title="api.resources.event.Event.get" href="#api.resources.event.Event.get">get</a></code></li>
<li><code><a title="api.resources.event.Event.methods" href="#api.resources.event.Event.methods">methods</a></code></li>
<li><code><a title="api.resources.event.Event.put" href="#api.resources.event.Event.put">put</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="api.resources.event.EventList" href="#api.resources.event.EventList">EventList</a></code></h4>
<ul class="">
<li><code><a title="api.resources.event.EventList.get" href="#api.resources.event.EventList.get">get</a></code></li>
<li><code><a title="api.resources.event.EventList.methods" href="#api.resources.event.EventList.methods">methods</a></code></li>
<li><code><a title="api.resources.event.EventList.post" href="#api.resources.event.EventList.post">post</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.5</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>